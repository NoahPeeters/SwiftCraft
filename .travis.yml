language: swift
osx_image: xcode9.3

cache:
  directories:
  - Carthage

env:
  global:
    - LC_CTYPE=en_US.UTF-8
    - LANG=en_US.UTF-8
    - PROJECT=SwiftCraft.xcodeproj

matrix:
  include:
    - script:
       - set -o pipefail
       - carthage bootstrap --no-use-binaries --cache-builds
       - xcodebuild -project "$PROJECT" -scheme "SwiftCraft iOS" -destination "OS=11.3,name=iPhone X" build | xcpretty
    - script:
       - set -o pipefail
       - carthage bootstrap --no-use-binaries --cache-builds
       - xcodebuild -project "$PROJECT" -scheme "SwiftCraft tvOS" -destination "OS=11.3,name=Apple TV 4K" build | xcpretty
    - script:
       - set -o pipefail
       - carthage bootstrap --no-use-binaries --cache-builds
       - xcodebuild -project "$PROJECT" -scheme "SwiftCraft macOS" -destination "arch=x86_64" build | xcpretty
    - script:
       - brew install openssl
       - swift build
